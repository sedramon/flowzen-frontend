<div class="open-session-dialog">
  <!-- Dialog Content -->
  <div class="dialog-content">
    <form [formGroup]="openSessionForm" (ngSubmit)="openSession()">
      
      <!-- Facility Selection -->
      <p-floatLabel class="full-width">
        <p-select 
          formControlName="facility" 
          inputId="facility"
          [options]="facilityOptions"
          optionLabel="label"
          optionValue="value"
          styleClass="full-width">
        </p-select>
        <label for="facility">Lokacija</label>
      </p-floatLabel>
      <small class="p-error" *ngIf="openSessionForm.get('facility')?.hasError('required') && openSessionForm.get('facility')?.touched">
        {{ getErrorMessage('facility') }}
      </small>

      <!-- Opening Float -->
      <p-floatLabel class="full-width">
        <p-inputNumber 
          formControlName="openingFloat" 
          inputId="openingFloat"
          [min]="0"
          [step]="1"
          mode="decimal"
          [minFractionDigits]="0"
          [maxFractionDigits]="0"
          styleClass="full-width">
        </p-inputNumber>
        <label for="openingFloat">Početni Float (RSD)</label>
      </p-floatLabel>
      <small class="p-error" *ngIf="openSessionForm.get('openingFloat')?.hasError('required') && openSessionForm.get('openingFloat')?.touched">
        {{ getErrorMessage('openingFloat') }}
      </small>
      <small class="p-error" *ngIf="openSessionForm.get('openingFloat')?.hasError('min') && openSessionForm.get('openingFloat')?.touched">
        {{ getErrorMessage('openingFloat') }}
      </small>

      <!-- Note -->
      <p-floatLabel class="full-width">
          <textarea 
          pInputTextarea
          formControlName="note" 
          id="note"
          placeholder="Dodatne napomene..."
          [rows]="3"
          class="full-width">
        </textarea>
        <label for="note">Napomena (opciono)</label>
      </p-floatLabel>

      <!-- Preview -->
      <div class="preview-section" *ngIf="openSessionForm.get('openingFloat')?.value">
        <p-card>
          <ng-template pTemplate="header">
            <h4>Pregled Sesije</h4>
          </ng-template>
          <div class="preview-details">
            <div class="preview-row">
              <span class="label">Lokacija:</span>
              <span class="value">
                {{ getSelectedFacilityName() }}
              </span>
            </div>
            <div class="preview-row">
              <span class="label">Početni Float:</span>
              <span class="value amount">{{ formatAmount(openSessionForm.get('openingFloat')?.value) }}</span>
            </div>
            <div class="preview-row" *ngIf="openSessionForm.get('note')?.value">
              <span class="label">Napomena:</span>
              <span class="value">{{ openSessionForm.get('note')?.value }}</span>
            </div>
          </div>
        </p-card>
      </div>
    </form>
  </div>

  <!-- Dialog Actions -->
  <div class="dialog-actions">
    <p-button 
      label="Otkaži" 
      icon="pi pi-times" 
      (onClick)="cancel()"
      [disabled]="processing"
      severity="secondary"
      [text]="true">
    </p-button>
    
    <p-button 
      label="{{ processing ? 'Otvaranje...' : 'Otvori Sesiju' }}" 
      icon="pi pi-wallet" 
      (onClick)="openSession()"
      [disabled]="openSessionForm.invalid || processing"
      [loading]="processing"
      severity="primary">
    </p-button>
  </div>
</div>
